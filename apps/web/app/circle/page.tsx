'use client';import {useEffect,useState} from 'react';export default function Circle(){const api=process.env.NEXT_PUBLIC_API_URL!;const[cid,setCid]=useState('');const[idx,setIdx]=useState(0);const[mem,setMem]=useState('');const[status,setStatus]=useState<any>(null);const[msg,setMsg]=useState('');const load=async()=>{if(!cid)return;const r=await fetch(`${api}/circles/${cid}/rounds/${idx}`);setStatus(await r.json())};const pay=async()=>{const r=await fetch(`${api}/circles/${cid}/rounds/${idx}/contributions`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({membershipId:mem,amountMinor:1000000})});setMsg(JSON.stringify(await r.json()));load()};const payout=async()=>{const r=await fetch(`${api}/circles/${cid}/rounds/${idx}/payout`,{method:'POST'});setMsg(JSON.stringify(await r.json()));load()};useEffect(()=>{if(cid)load()},[cid,idx]);return(<main><h2 style={{fontSize:22}}>Circle Dashboard</h2><label>Circle ID <input value={cid} onChange={e=>setCid(e.target.value)} /></label><label>Round Index <input type='number' value={idx} onChange={e=>setIdx(Number(e.target.value))} /></label><button onClick={load} style={btn}>Refresh</button>{status&&<div style={{marginTop:12,padding:12,border:'1px solid #eee',borderRadius:12}}><div>Round: <b>{status.roundIndex}</b></div><div>Due: {new Date(status.dueAtISO).toLocaleString()}</div><div>Status: <b>{status.status}</b></div><div>Hands: {status.receivedHands}/{status.requiredHands}</div></div>}<h3 style={{marginTop:16}}>Actions</h3><label>Membership ID <input value={mem} onChange={e=>setMem(e.target.value)} /></label><div style={{display:'flex',gap:10}}><button onClick={pay} style={btn}>Pay Hand (simulate)</button><button onClick={payout} style={btn}>Trigger Payout</button></div>{msg&&<pre style={{background:'#f7f7f7',padding:12,marginTop:12}}>{msg}</pre>}</main>)} const btn:React.CSSProperties={padding:'10px 14px',borderRadius:10,border:'1px solid #ddd',width:'fit-content'}
